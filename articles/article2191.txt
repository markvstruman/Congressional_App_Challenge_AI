CNN —

The Senate passed a $1.7 trillion yearlong federal government spending bill Thursday afternoon, sending it to the House for a vote before federal funding lapses late Friday night.

The legislation includes $772.5 billion for nondefense discretionary programs and $858 billion in defense funding, according to a bill summary from Democratic Sen. Patrick Leahy, chair of the Senate Committee on Appropriations.

The sweeping package includes roughly $45 billion in emergency assistance to Ukraine and NATO allies, boosts in spending for disaster aid, college access, child care, mental health and food assistance, more support for the military and veterans and additional funds for the US Capitol Police, according to Leahy’s summary and one from Sen. Richard Shelby of Alabama, the top Republican on the Senate Appropriations Committee. It also includes several major Medicaid provisions, including one that could disenroll up to 19 million people from the nation’s health insurance program for low-income Americans.

However, the bill, which runs more than 4,000 pages, left out several measures that some lawmakers had fought to include. An expansion of the child tax credit, as well as multiple other corporate and individual tax breaks, did not make it into the final bill. Neither did legislation to allow cannabis companies to bank their cash reserves – known as the Safe Banking Act – or a bill to help Afghan evacuees in the US gain lawful permanent residency. And the spending package did not include a White House request for roughly $10 billion in additional funding for Covid-19 response.

The spending bill, which would keep the government operating through September, the end of the fiscal year, is the product of lengthy negotiations between top congressional Democrats and Republicans. Lawmakers reached a “bipartisan, bicameral framework” last week following a dispute between the two parties over how much money should be spent on non-defense domestic priorities. They worked through the weekend to craft the legislation.

Congress originally passed a continuing resolution on September 30 to temporarily fund the government in fiscal year 2023, which began October 1.

Here’s what’s in the bill:

More aid for Ukraine: The spending bill would provide roughly $45 billion to help support Ukraine’s efforts to defend itself against Russia’s attack.

About $9 billion of the funding would go to Ukraine’s military to pay for a variety of things including training, weapons, logistics support and salaries. Nearly $12 billion would be used to replenish US stocks of equipment sent to Ukraine through presidential drawdown authority.

Also, it would provide $13 billion for economic support to the Ukrainian government.

Other funds would address humanitarian and infrastructure needs, as well as support European Command operations.

Emergency disaster assistance: The bill would appropriate more than $38 billion in emergency funding to help Americans in the west and southeast affected by recent natural disasters, including tornadoes, hurricanes, flooding and wildfires. It would aid farmers, provide economic development assistance for communities, repair and reconstruct federal facilities and direct money to the Federal Emergency Management Agency’s Disaster Relief Fund, among other initiatives.

Overhaul of the electoral vote-counting law: A provision in the legislation aims at making it harder to overturn a certified presidential election, in a direct response to the January 6 attack on the US Capitol.

The changes would overhaul the 1887 Electoral Count Act, which President Donald Trump tried to use to overturn the 2020 election.

The legislation would clarify the vice president’s role while overseeing the certification of the electoral result to be completely ceremonial. It also would create a set of stipulations designed to make it harder for there to be any confusion over the accurate slate of electors from each state.

Funding for January 6 attack prosecutions: The bill would provide $2.6 billion for US Attorneys, which would include funding efforts “to further support prosecutions related to the January 6 attack on the Capitol and domestic terrorism cases,” according to a fact sheet.

The package also gives $11.3 billion to the Federal Bureau of Investigation, including for efforts to investigate extremist violence and domestic terrorism.

The funding measures are part of nearly $39 billion that would be for the Justice Department.

Changes to Medicaid and other health care programs: The spending bill would phase out the requirement that prevented states from disenrolling Medicaid recipients as long as the national public health emergency was in effect in exchange for an enhanced federal match. This continuous coverage measure was enacted as part of a Covid-19 relief package passed in March 2020 and has led to a record 90 million Medicaid enrollees.

Under the spending bill, states would be able to start evaluating Medicaid enrollees’ eligibility as of April 1. The redetermination process would take place over at least 12 months. The measure also calls for phasing down the enhanced federal Medicaid funding through December 31, 2023, though the states would have to meet certain conditions during that period.

Up to 19 million people could lose their Medicaid benefits, according to estimates, though many would be eligible for other coverage.

Also, under a provision in the spending bill, Medicaid and the Children’s Health Insurance Program, known as CHIP, would offer 12 months of continuous coverage for children. This would allow the 40 million children on Medicaid and CHIP to have uninterrupted access to health care throughout the year.

In addition, the bill makes permanent the option for states to offer 12 months of postpartum coverage for low-income mothers through Medicaid, rather than just 60 days. More than two dozen states, plus the District of Columbia, have implemented the measure, which was available on a temporary basis through the American Rescue Plan, according to the Kaiser Family Foundation. Another seven states are planning to implement the option.

Plus, the package would provide more money for National Institutes of Health, the Centers for Disease Control and Prevention and the Assistant Secretary for Preparedness and Response. The funds are intended to speed the development of new therapies, diagnostics and preventive measures, beef up public health activities and strengthen the nation’s biosecurity by accelerating development of medical countermeasures for pandemic threats and fortifying stockpiles and supply chains for drugs, masks and other supplies.

Higher maximum Pell grant awards: The bill would increase the maximum Pell grant award by $500 to $7,395 for the coming school year. This would be the largest boost since the 2009-2010 school year. About 7 million students, many from lower-income families, receive Pell grants every year to help them afford college.

Increased support for the military and veterans: The package would fund a 4.6% pay raise for troops and a 22.4% increase in support for Veteran Administration medical care, which provides health services for 7.3 million veterans.

It would include nearly $53 billion to address higher inflation and $2.7 billion – a 25% increase – to support critical services and housing assistance for veterans and their families.

The bill also would allocate $5 billion for the Cost of War Toxic Exposures Fund, which provides additional funding to implement the landmark PACT Act that expands eligibility for health care services and benefits to veterans with conditions related to toxic exposure during their service.

Beefing up nutrition assistance: The legislation would establish a permanent nationwide Summer EBT program, starting in the summer of 2024, according to Share Our Strength, an anti-hunger advocacy group. It would provide families whose children are eligible for free or reduced-price school meal with a $40 grocery benefit per child per month, indexed to inflation.

It would also change the rules governing summer meals programs in rural areas. Children would be able to take home or receive delivery of up to 10 days worth of meals, rather than have to consume the food at a specific site and time.

The bill would also help families who have had their food stamp benefits stolen since October 1 through what’s known as “SNAP skimming.” It would provide them with retroactive federal reimbursement of the funds, which criminals steal by attaching devices to point-of-sale machines or PIN pads to get card numbers and other information from electronic benefits transfer cards.

More money for child care: The legislation would provide $8 billion for the Child Care and Development Block Grant, a 30% increase in funding. The grant gives financial assistance to low-income families to afford child care.

Also, Head Start would receive nearly $12 billion, an 8.6% boost. The program helps young children from low-income families prepare for school.

Help to pay utility bills: The bill would provide $5 billion for the Low Income Home Energy Assistance Program. Combined with the $1 billion contained in the earlier continuing resolution, this would be the largest regular appropriation for the program, according to the National Energy Assistance Directors Association. Home heating and cooling costs – and the applications for federal aid in paying the bills – have soared this year.

Enhance retirement savings: The bill contains new retirement rules that could make it easier for Americans to accumulate retirement savings – and less costly to withdraw them. Among other things, the provisions would allow penalty-free withdrawals for some emergency expenses, let employers offer matching retirement contributions for a worker’s student loan payments and increase how much older workers may save in employer retirement plans.

More support for the environment: The package would provide an additional $576 million for the Environmental Protection Agency, bringing its funding up to $10.1 billion. It would increase support for enforcement and compliance, as well as clean air, water and toxic chemical programs, after years of flat funding.

It also would boost funding for the National Park Service by 6.4%, restoring 500 of the 3,000 staff positions lost over the past decade. This would be intended to help the agency handle substantial increases in visitation.

Plus, the legislation would provide an additional 14% in funding for wildland firefighting.

Additional funding for the US Capitol Police: The bill would provide an additional $132 million for the Capitol Police for a total of nearly $735 million. It would allow the department to hire up to 137 sworn officers and 123 support and civilian personnel, bringing the force to a projected level of 2,126 sworn officers and 567 civilians.

It would also give $2 million to provide off-campus security for lawmakers in response to evolving and growing threats.

Investments in homelessness prevention and affordable housing: The legislation would provide $3.6 billion for homeless assistance grants, a 13% increase. It would serve more than 1 million people experiencing homelessness.

The package also would funnel nearly $6.4 billion to the Community Development Block Grant formula program and related local economic and community development projects that benefit low- and moderate income areas and people, an increase of almost $1.6 billion.

Plus, it would provide $1.5 billion for the HOME Investment Partnerships Program, which would lead to the construction of nearly 10,000 new rental and homebuyer units and maintain the record investment from the last fiscal year.

More resources for children’s mental health and for substance abuse: The bill would provide more funds to increase access to mental health services for children and schools. It also would invest more money to address the opioid epidemic and substance use disorder.

Tiktok ban from federal devices: The legislation would ban TikTok, the Chinese-owned short-form video app, from federal government devices.

Some lawmakers have raised bipartisan concerns that China’s national security laws could force TikTok – or its parent, ByteDance – to hand over the personal data of its US users. Recently, a wave of states led by Republican governors have introduced state-level restrictions on the use of TikTok on government-owned devices.

Protections for pregnant workers: The bill also aims at providing pregnant workers with workplace accommodations – such as additional bathroom breaks, stools or relief from heavy lifting duties – needed for healthy pregnancies. It would prevent them from being forced to take leave or losing their jobs, as well as bar employers from denying employment opportunities to women based on their need for reasonable accommodations due to childbirth or related medical conditions.

What’s not in the bill

Enhanced child tax credit: A coalition of Democratic lawmakers and consumer advocates pushed hard to extend at least one provision of the enhanced child tax credit, which was in effect last year thanks to the Democrats’ $1.9 trillion American Rescue Plan. Their priority was to make the credit more refundable so more of the lowest-income families can qualify. Nearly 19 million kids won’t receive the full $2,000 benefit this year because their parents earn too little, according to a Tax Policy Center estimate.

New cannabis banking rules: Lawmakers considered including a provision in the spending bill that would make it easier for licensed cannabis businesses to accept credit cards – but it was left out of the legislation. Known as the Safe Banking Act, which previously passed the House, the provision would prohibit federal regulators from taking punitive measures against banks for providing services to legitimate cannabis businesses.

Even though 47 states have legalized some form of marijuana, cannabis remains illegal on the federal level. That means financial institutions providing banking services to cannabis businesses are subject to criminal prosecution – leaving many legal growers and sellers locked out of the banking system.

Covid-19 response: Lawmakers did not include a White House request for an additional $10 billion in funding for Covid-19, which would have been aimed at continued access to and development of vaccines and therapeutics, among other things. Earlier in the year, the Biden administration unsuccessfully pushed for $22.5 billion in extra funds.

FBI headquarters: There was also no final resolution on where the new FBI headquarters will be located, a major point of contention as lawmakers from Maryland – namely House Majority Leader Steny Hoyer – pushed to bring the law enforcement agency into their state. In a deal worked through by Senate Majority Leader Chuck Schumer, the General Services Administration would be required to conduct “separate and detailed consultations” with Maryland and Virginia representatives about potential sites in each of the states, according to a Senate Democratic aide.

Afghan Adjustment Act: Also not included in the spending bill was the Afghan Adjustment Act, which would have helped Afghan allies who run the risk of deportation from the US. It would have given those evacuees a pathway to lawful permanent residency before their temporary status, known as humanitarian parole, expires in 2023. Many congressional Republicans raised concerns about vetting and other issues, but the legislation’s supporters, including former US military leaders, argued those worries have been addressed.

Legislation to extend and expand Special Immigrant Visas for Afghans who worked with the US during the war there and want to come to America is included in the spending bill.

This story has been updated with additional information.